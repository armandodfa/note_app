{"ast":null,"code":"import _objectSpread from\"/Users/armanrazdyk/todo-react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/armanrazdyk/todo-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/armanrazdyk/todo-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/armanrazdyk/todo-react/node_modules/@babel/runtime/regenerator/index.js\";import React,{useReducer}from'react';import axios from'axios';import{FirebaseContext}from'./firebaseContext';import{firebaseReducer}from'./firebaseReducer';import{ADD_NOTE,FETCH_NOTES,REMOVE_NOTE,SHOW_LOADER}from'../types';import{jsx as _jsx}from\"react/jsx-runtime\";var url=process.env.REACT_APP_DB_URL;export var FirebaseState=function FirebaseState(_ref){var children=_ref.children;var initialState={notes:[],loading:false};var _useReducer=useReducer(firebaseReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var showLoader=function showLoader(){return dispatch({type:SHOW_LOADER});};var fetchNotes=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,payload;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:showLoader();_context.next=3;return axios.get(\"\".concat(url,\"/notes.json\"));case 3:res=_context.sent;payload=Object.keys(res.data).map(function(key){return _objectSpread(_objectSpread({},res.data[key]),{},{id:key});});console.log('fetchNotes',res.data);dispatch({type:FETCH_NOTES,payload:payload});case 7:case\"end\":return _context.stop();}}},_callee);}));return function fetchNotes(){return _ref2.apply(this,arguments);};}();var addNote=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(title){var note,res,payload;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:note={title:title,date:new Date().toJSON()};_context2.prev=1;_context2.next=4;return axios.post(\"\".concat(url,\"/notes.json\"),note);case 4:res=_context2.sent;console.log('addNote',res.data);payload=_objectSpread(_objectSpread({},note),{},{id:res.data.name});dispatch({type:ADD_NOTE,payload:payload});_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);throw new Error(_context2.t0.message);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[1,10]]);}));return function addNote(_x){return _ref3.apply(this,arguments);};}();var removeNote=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.delete(\"\".concat(url,\"/notes/\").concat(id,\".json\"));case 2:dispatch({type:REMOVE_NOTE,payload:id});case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function removeNote(_x2){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsx(FirebaseContext.Provider,{value:{showLoader:showLoader,fetchNotes:fetchNotes,addNote:addNote,removeNote:removeNote,loading:state.loading,notes:state.notes},children:children});};","map":{"version":3,"sources":["/Users/armanrazdyk/todo-react/src/context/firebase/FirebaseState.js"],"names":["React","useReducer","axios","FirebaseContext","firebaseReducer","ADD_NOTE","FETCH_NOTES","REMOVE_NOTE","SHOW_LOADER","url","process","env","REACT_APP_DB_URL","FirebaseState","children","initialState","notes","loading","state","dispatch","showLoader","type","fetchNotes","get","res","payload","Object","keys","data","map","key","id","console","log","addNote","title","note","date","Date","toJSON","post","name","Error","message","removeNote","delete"],"mappings":"8cAAA,MAAOA,CAAAA,KAAP,EAAgBC,UAAhB,KAAkC,OAAlC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,eAAT,KAAgC,mBAAhC,CACA,OAASC,eAAT,KAAgC,mBAAhC,CACA,OAASC,QAAT,CAAmBC,WAAnB,CAAgCC,WAAhC,CAA6CC,WAA7C,KAAgE,UAAhE,C,2CAEA,GAAMC,CAAAA,GAAG,CAAGC,OAAO,CAACC,GAAR,CAAYC,gBAAxB,CAEA,MAAO,IAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,MAAkB,IAAfC,CAAAA,QAAe,MAAfA,QAAe,CAC3C,GAAMC,CAAAA,YAAY,CAAG,CACjBC,KAAK,CAAE,EADU,CAEjBC,OAAO,CAAE,KAFQ,CAArB,CAIA,gBAA0BhB,UAAU,CAACG,eAAD,CAAkBW,YAAlB,CAApC,4CAAOG,KAAP,iBAAcC,QAAd,iBAEA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,SAAMD,CAAAA,QAAQ,CAAC,CAAEE,IAAI,CAAEb,WAAR,CAAD,CAAd,EAAnB,CACA,GAAMc,CAAAA,UAAU,2FAAG,mJACfF,UAAU,GADK,sBAEGlB,CAAAA,KAAK,CAACqB,GAAN,WAAad,GAAb,gBAFH,QAETe,GAFS,eAGTC,OAHS,CAGCC,MAAM,CAACC,IAAP,CAAYH,GAAG,CAACI,IAAhB,EAAsBC,GAAtB,CAA0B,SAAAC,GAAG,CAAI,CAC7C,sCACON,GAAG,CAACI,IAAJ,CAASE,GAAT,CADP,MAEIC,EAAE,CAAED,GAFR,GAIH,CALe,CAHD,CASfE,OAAO,CAACC,GAAR,CAAY,YAAZ,CAA0BT,GAAG,CAACI,IAA9B,EACAT,QAAQ,CAAC,CAAEE,IAAI,CAAEf,WAAR,CAAqBmB,OAAO,CAAPA,OAArB,CAAD,CAAR,CAVe,sDAAH,kBAAVH,CAAAA,UAAU,2CAAhB,CAYA,GAAMY,CAAAA,OAAO,2FAAG,kBAAMC,KAAN,2IACNC,IADM,CACC,CACTD,KAAK,CAALA,KADS,CACFE,IAAI,CAAE,GAAIC,CAAAA,IAAJ,GAAWC,MAAX,EADJ,CADD,yCAKUrC,CAAAA,KAAK,CAACsC,IAAN,WAAc/B,GAAd,gBAAgC2B,IAAhC,CALV,QAKFZ,GALE,gBAMRQ,OAAO,CAACC,GAAR,CAAY,SAAZ,CAAuBT,GAAG,CAACI,IAA3B,EACMH,OAPE,gCAQDW,IARC,MASJL,EAAE,CAAEP,GAAG,CAACI,IAAJ,CAASa,IATT,GAWRtB,QAAQ,CAAC,CAAEE,IAAI,CAAEhB,QAAR,CAAkBoB,OAAO,CAAPA,OAAlB,CAAD,CAAR,CAXQ,0FAcF,IAAIiB,CAAAA,KAAJ,CAAU,aAAEC,OAAZ,CAdE,wEAAH,kBAAPT,CAAAA,OAAO,6CAAb,CAkBA,GAAMU,CAAAA,UAAU,2FAAG,kBAAMb,EAAN,6IACT7B,CAAAA,KAAK,CAAC2C,MAAN,WAAgBpC,GAAhB,mBAA6BsB,EAA7B,UADS,QAGfZ,QAAQ,CAAC,CAAEE,IAAI,CAAEd,WAAR,CAAqBkB,OAAO,CAAEM,EAA9B,CAAD,CAAR,CAHe,wDAAH,kBAAVa,CAAAA,UAAU,8CAAhB,CAMA,mBACI,KAAC,eAAD,CAAiB,QAAjB,EAA0B,KAAK,CAAE,CAC7BxB,UAAU,CAAVA,UAD6B,CAE7BE,UAAU,CAAVA,UAF6B,CAG7BY,OAAO,CAAPA,OAH6B,CAI7BU,UAAU,CAAVA,UAJ6B,CAK7B3B,OAAO,CAAEC,KAAK,CAACD,OALc,CAM7BD,KAAK,CAAEE,KAAK,CAACF,KANgB,CAAjC,UAQKF,QARL,EADJ,CAYH,CAxDM","sourcesContent":["import React, { useReducer } from 'react'\nimport axios from 'axios'\nimport { FirebaseContext } from './firebaseContext'\nimport { firebaseReducer } from './firebaseReducer'\nimport { ADD_NOTE, FETCH_NOTES, REMOVE_NOTE, SHOW_LOADER } from '../types'\n\nconst url = process.env.REACT_APP_DB_URL\n\nexport const FirebaseState = ({ children }) => {\n    const initialState = {\n        notes: [],\n        loading: false\n    }\n    const [state, dispatch] = useReducer(firebaseReducer, initialState)\n\n    const showLoader = () => dispatch({ type: SHOW_LOADER })\n    const fetchNotes = async () => {\n        showLoader()\n        const res = await axios.get(`${url}/notes.json`)\n        const payload = Object.keys(res.data).map(key => {\n            return {\n                ...res.data[key],\n                id: key\n            }\n        })\n        console.log('fetchNotes', res.data)\n        dispatch({ type: FETCH_NOTES, payload })\n    }\n    const addNote = async title => {\n        const note = {\n            title, date: new Date().toJSON()\n        }\n        try {\n            const res = await axios.post(`${url}/notes.json`, note)\n            console.log('addNote', res.data)\n            const payload = {\n                ...note,\n                id: res.data.name\n            }\n            dispatch({ type: ADD_NOTE, payload })\n\n        } catch (e) {\n            throw new Error(e.message)\n        }\n    }\n\n    const removeNote = async id => {\n        await axios.delete(`${url}/notes/${id}.json`)\n\n        dispatch({ type: REMOVE_NOTE, payload: id })\n    }\n\n    return (\n        <FirebaseContext.Provider value={{\n            showLoader,\n            fetchNotes,\n            addNote,\n            removeNote,\n            loading: state.loading,\n            notes: state.notes\n        }}>\n            {children}\n        </FirebaseContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}